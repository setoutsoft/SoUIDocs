<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="C++ 快速设计界面库"><meta name=author content="SoUI Team"><link href=https://X.org/Development/1/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.3"><title>4.1 xml 资源文件定义 - SoUI3官方文档</title><link rel=stylesheet href=../../assets/stylesheets/main.edf004c2.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#ffffff><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../../static/css/extra.css><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=white data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#41-xml class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=SoUI3官方文档 class="md-header__button md-logo" aria-label=SoUI3官方文档 data-md-component=logo> <img src=../../static/img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SoUI3官方文档 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 4.1 xml 资源文件定义 </span> </div> </div> </div> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label=选择当前语言> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=/ hreflang class=md-select__link> 中文 </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/2926295173/SoUIDocs/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> 2926295173/SoUIDocs </div> </a> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Start </a> </li> <li class=md-tabs__item> <a href=../../Overview/10/ class=md-tabs__link> 概述 </a> </li> <li class=md-tabs__item> <a href=../../BuildSoUI/build/ class=md-tabs__link> 编译 </a> </li> <li class=md-tabs__item> <a href=../../Create/31/ class=md-tabs__link> 创建 </a> </li> <li class=md-tabs__item> <a href=../0/ class="md-tabs__link md-tabs__link--active"> 开发 </a> </li> <li class=md-tabs__item> <a href=../../Control/Summary/ class=md-tabs__link> 控件 </a> </li> <li class=md-tabs__item> <a href=../../Ask/Summary/ class=md-tabs__link> 提问 </a> </li> <li class=md-tabs__item> <a href=../../Others/1/ class=md-tabs__link> 其他 </a> </li> <li class=md-tabs__item> <a href=../../updatelog/ class=md-tabs__link> 更新 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SoUI3官方文档 class="md-nav__button md-logo" aria-label=SoUI3官方文档 data-md-component=logo> <img src=../../static/img/logo.png alt=logo> </a> SoUI3官方文档 </label> <div class=md-nav__source> <a href=https://github.com/2926295173/SoUIDocs/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> 2926295173/SoUIDocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Start <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Start data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Start </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 引言 </a> </li> <li class=md-nav__item> <a href=../../discussion/ class=md-nav__link> 讨论交流与问题反馈 </a> </li> <li class=md-nav__item> <a href=../../theme/ class=md-nav__link> 网站主题配色 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> 概述 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=概述 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 概述 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Overview/10/ class=md-nav__link> 1、概述 </a> </li> <li class=md-nav__item> <a href=../../Overview/11/ class=md-nav__link> 1.1 SOUI 是什么？ </a> </li> <li class=md-nav__item> <a href=../../Overview/12/ class=md-nav__link> 1.2 SOUI 相对于 DuiEngine 的改进 </a> </li> <li class=md-nav__item> <a href=../../Overview/13/ class=md-nav__link> 1.3 SOUI 模块结构 </a> </li> <li class=md-nav__item> <a href=../../Overview/14/ class=md-nav__link> 1.4 模块结构图及框架图 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 编译 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=编译 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 编译 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../BuildSoUI/build/ class=md-nav__link> 2、SOUI 的编译 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> 创建 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=创建 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 创建 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Create/31/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/32/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/33/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/34/ class=md-nav__link> 3、开始使用 SOUI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> 开发 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=开发 data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../0/ class=md-nav__link> 4、SOUI 开发说明 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> 4.1 xml 资源文件定义 </a> </li> <li class=md-nav__item> <a href=../2/ class=md-nav__link> 4.2 系统资源管理 </a> </li> <li class=md-nav__item> <a href=../3/ class=md-nav__link> 4.3 应用程序中资源的组织 </a> </li> <li class=md-nav__item> <a href=../4/ class=md-nav__link> 4.4 在 SOUI 中用九宫格拉伸方式显示一个图片资源 </a> </li> <li class=md-nav__item> <a href=../7/ class=md-nav__link> 4.7 在 SOUI 中使用有窗口句柄的子窗口 </a> </li> <li class=md-nav__item> <a href=../8/ class=md-nav__link> 4.8 SOUI 中控件事件的响应 </a> </li> <li class=md-nav__item> <a href=../9/ class=md-nav__link> 4.9 SOUI 多语言翻译机制 </a> </li> <li class=md-nav__item> <a href=../10/ class=md-nav__link> 4.10 自定义控件 </a> </li> <li class=md-nav__item> <a href=../11/ class=md-nav__link> 4.11 在 SOUI 中使用定时器 </a> </li> <li class=md-nav__item> <a href=../12/ class=md-nav__link> 4.12 在 SOUI 中消息通讯 </a> </li> <li class=md-nav__item> <a href=../13/ class=md-nav__link> 4.13 使用窗口的 cache 属性加速 SOUI 的渲染 </a> </li> <li class=md-nav__item> <a href=../14/ class=md-nav__link> 4.14 在 SOUI 中实现 PreTranslateMessage </a> </li> <li class=md-nav__item> <a href=../15/ class=md-nav__link> 4.15 提高 SOUI 应用程序渲染性能的三种武器 </a> </li> <li class=md-nav__item> <a href=../16/ class=md-nav__link> 4.16 在 SOUI 中使用分层窗口 </a> </li> <li class=md-nav__item> <a href=../17/ class=md-nav__link> 4.17 在 SOUI 中的控件注册机制 </a> </li> <li class=md-nav__item> <a href=../18/ class=md-nav__link> 4.18 在 SOUI 中使用代码向窗口中插入子窗口 </a> </li> <li class=md-nav__item> <a href=../19/ class=md-nav__link> 4.19 在 SOUI 中使用 LUA 脚本开发界面 </a> </li> <li class=md-nav__item> <a href=../20/ class=md-nav__link> 4.20 导出 SOUI 对象到 LUA 脚本 </a> </li> <li class=md-nav__item> <a href=../21/ class=md-nav__link> 4.21 在 SOUI 中做事件分发处理 </a> </li> <li class=md-nav__item> <a href=../22/ class=md-nav__link> 4.22 在 SOUI 中使用异步通知 </a> </li> <li class=md-nav__item> <a href=../23/ class=md-nav__link> 4.23 在 SOUI2.0 中像 android 一样使用资源 </a> </li> <li class=md-nav__item> <a href=../24/ class=md-nav__link> 4.24 两个 SOUI 新控件 ---- SListView 和 SComboView（借用 Andorid 的设计） </a> </li> <li class=md-nav__item> <a href=../25/ class=md-nav__link> 4.25 在 SOUI 中控件属性查询方法 </a> </li> <li class=md-nav__item> <a href=../26/ class=md-nav__link> 4.26 使用 SOUI 的 SMCListView 控件 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> 控件 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=控件 data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 控件 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Control/Summary/ class=md-nav__link> 5、控件说明（SOUI） </a> </li> <li class=md-nav__item> <a href=../../Control/51/ class=md-nav__link> 5.1 SWindow 类 </a> </li> <li class=md-nav__item> <a href=../../Control/52/ class=md-nav__link> 5.2 SwndStyle 类 </a> </li> <li class=md-nav__item> <a href=../../Control/53/ class=md-nav__link> 5.3 SHostWndAttr 类 </a> </li> <li class=md-nav__item> <a href=../../Control/54/ class=md-nav__link> 5.4 静态文本控件 </a> </li> <li class=md-nav__item> <a href=../../Control/55/ class=md-nav__link> 5.5 超链接控件 </a> </li> <li class=md-nav__item> <a href=../../Control/56/ class=md-nav__link> 5.6 按钮/图片按钮控件 </a> </li> <li class=md-nav__item> <a href=../../Control/57/ class=md-nav__link> 5.7 图片控件 </a> </li> <li class=md-nav__item> <a href=../../Control/58/ class=md-nav__link> 5.8 动画图片窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/59/ class=md-nav__link> 5.9 线条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/510/ class=md-nav__link> 5.10 复选框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/511/ class=md-nav__link> 5.11 图标控件 </a> </li> <li class=md-nav__item> <a href=../../Control/512/ class=md-nav__link> 5.12 单选框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/513/ class=md-nav__link> 5.13 Toggle 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/514/ class=md-nav__link> 5.14 组控件 </a> </li> <li class=md-nav__item> <a href=../../Control/515/ class=md-nav__link> 5.15 可输入 CommboBox 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/516/ class=md-nav__link> 5.16 日历控件 </a> </li> <li class=md-nav__item> <a href=../../Control/517/ class=md-nav__link> 5.17 标签控件 </a> </li> <li class=md-nav__item> <a href=../../Control/518/ class=md-nav__link> 5.18 富文本编辑框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/519/ class=md-nav__link> 5.19 简单 edit 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/520/ class=md-nav__link> 5.20 表头控件 </a> </li> <li class=md-nav__item> <a href=../../Control/521/ class=md-nav__link> 5.21 热键控件 </a> </li> <li class=md-nav__item> <a href=../../Control/522/ class=md-nav__link> 5.22 列表框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/523/ class=md-nav__link> 5.23 列表控件 </a> </li> <li class=md-nav__item> <a href=../../Control/524/ class=md-nav__link> 5.24 滚动条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/525/ class=md-nav__link> 5.25 滑块工具条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/526/ class=md-nav__link> 5.26 分割窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/527/ class=md-nav__link> 5.27 分割窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/528/ class=md-nav__link> 5.28 Tab 标签页面控件 </a> </li> <li class=md-nav__item> <a href=../../Control/529/ class=md-nav__link> 5.29 Tab 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/530/ class=md-nav__link> 5.30 树控件 </a> </li> <li class=md-nav__item> <a href=../../Control/531/ class=md-nav__link> 5.31 按钮控件 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> 提问 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=提问 data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 提问 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Ask/Summary/ class=md-nav__link> 6、常见问题 </a> </li> <li class=md-nav__item> <a href=../../Ask/1/ class=md-nav__link> 6.1 模块 utilities 为什么要用 DLL 编译？ </a> </li> <li class=md-nav__item> <a href=../../Ask/2/ class=md-nav__link> 6.2 为什么在 soui 中加载 JPG 文件失败？ </a> </li> <li class=md-nav__item> <a href=../../Ask/3/ class=md-nav__link> 6.3 不注册 COM 在 Richedit 中使 OLE 支持复制粘贴 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> 其他 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=其他 data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/1/ class=md-nav__link> 7.1 谈谈 SOUI 与 WTL </a> </li> <li class=md-nav__item> <a href=../../Others/2/ class=md-nav__link> 7.2 在 SOUI 中非半透明窗口如何实现圆角窗口？ </a> </li> <li class=md-nav__item> <a href=../../Others/3/ class=md-nav__link> 7.4 一种高效的可变行高列表行定位算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> 更新 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=更新 data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 更新 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../updatelog/ class=md-nav__link> SoUI 版本更新日志 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/2926295173/SoUIDocs/blob/main/docs/zh/docs/Development/1.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=41-xml>4.1 xml 资源文件定义<a class=headerlink href=#41-xml title="Permanent link">&para;</a></h1> <p>基于 SOUI 界面库的程序，存在一个 UI 资源索引文件(uires.idx)，此文件是一个标准 xml 文件，其默认位置是 uires 文件所在路径下的 uires\uires.idx。如果使用了 PE 资源或者 zip 压缩文件，来保存所有资源文件，则此文件的位置不会改变。 此文件中可以定义程序的全局配置、XML 文件、字体、图片、文字等资源，示例如下：</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;resource&gt;</span>
 <span class=nt>&lt;UIDEF&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;xml_init&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\init.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/UIDEF&gt;</span>
 <span class=nt>&lt;ICON&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;LOGO&quot;</span> <span class=na>path=</span><span class=s>&quot;image\img_logo.ico&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/ICON&gt;</span>
 <span class=nt>&lt;CURSOR&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;ANI_ARROW&quot;</span> <span class=na>path=</span><span class=s>&quot;image\021.ani&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;CUR_TST&quot;</span> <span class=na>path=</span><span class=s>&quot;image\camera_capture.cur&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/CURSOR&gt;</span>
 <span class=nt>&lt;LAYOUT&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;maindlg&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\dlg_main.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;menu_test&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\menu_test.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_layout&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_layout.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_treebox&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_treebox.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_treectrl&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_treectrl.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_misc&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_misc.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_webkit&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_webkit.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;page_about&quot;</span> <span class=na>path=</span><span class=s>&quot;xml\page_about.xml&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/LAYOUT&gt;</span>
 <span class=nt>&lt;IMGX&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_page_icons&quot;</span> <span class=na>path=</span><span class=s>&quot;image\page_icons.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_small_icons&quot;</span> <span class=na>path=</span><span class=s>&quot;image\small_icons.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;webbtn_back&quot;</span> <span class=na>path=</span><span class=s>&quot;image\webbtn_back.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;webbtn_forward&quot;</span> <span class=na>path=</span><span class=s>&quot;image\webbtn_forward.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;webbtn_refresh&quot;</span> <span class=na>path=</span><span class=s>&quot;image\webbtn_refresh.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_treeicon&quot;</span> <span class=na>path=</span><span class=s>&quot;image\TreeIcon.png&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_menu_border&quot;</span> <span class=na>path=</span><span class=s>&quot;image\menuborder.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_vscroll&quot;</span> <span class=na>path=</span><span class=s>&quot;image\vscrollbar.png&quot;</span> <span class=nt>/&gt;</span> 
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_tab_left&quot;</span> <span class=na>path=</span><span class=s>&quot;image\tab_left.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_tab_left_splitter&quot;</span> <span class=na>path=</span><span class=s>&quot;image\tab_left_splitter.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;png_tab_main&quot;</span> <span class=na>path=</span><span class=s>&quot;image\tab_main.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;btn_menu&quot;</span> <span class=na>path=</span><span class=s>&quot;image\btn_menu.png&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/IMGX&gt;</span>
 <span class=nt>&lt;GIF&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;gif_horse&quot;</span> <span class=na>path=</span><span class=s>&quot;image\horse.gif&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;gif_penguin&quot;</span> <span class=na>path=</span><span class=s>&quot;image\penguin.gif&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/GIF&gt;</span>
 <span class=nt>&lt;rtf&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;rtf_test&quot;</span> <span class=na>path=</span><span class=s>&quot;rtf\RTF 测试.rtf&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/rtf&gt;</span>
 <span class=nt>&lt;script&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;lua_test&quot;</span> <span class=na>path=</span><span class=s>&quot;lua\test.lua&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/script&gt;</span>
 <span class=nt>&lt;translator&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&quot;lang_cn&quot;</span> <span class=na>path=</span><span class=s>&quot;translation files\lang_cn.xml&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/translator&gt;</span>
<span class=nt>&lt;/resource&gt;</span>
</code></pre></div> <p>uires.idx 文件是 SOUI 资源的入口，定义了程序中使用的各种资源，以"resource"为根节 点。在 soui-demo 的 uires.idx 中，定义了 UIDEF，ICON，CURSOR，LAYOUT， IMGX，GIF，rtf，script，translator 这些资源类型。 其实你还可以定义任意的资源类型，只要类型长度不超过 30 个字符。 每一个资源类型下都是一些 file 元素，每个 file 包含两个属性：name 及 path。 name 是 UI 布局的 XML 文件引用该资源的标识，而 path 则是该资源真实的文件存储路 径。 除了 UIDEF 中定义的 xml_init 及 layout 中定义的布局 XML 外，其它资源都比较简单， 就是提供一种从 name 映射文件的方式。 关于 XML 定义的大概顺序是： 1：资源引入 uires.idx (这里定义界面要使用的一些资源) 格式: &lt;资源类型&gt; Name = 资源自定义名称， path=资源路径</p> <!--资源类型--> <p>2：定义全局变量 init.xml (这里定义全局变量并用资源初始化这些全局变量) 格式： &lt;变量类型&gt; Name=变量名称， src=资源类型：资源别名， 控件属性...</p> <!--变量类型--> <p>3: 使用全局变量 dlg_main.xml(这里开始引用上面的变量)</p> <p>4.1.1 init.xml 资源文件 UIDEF 资源（布局 XML 再单独开篇介绍） 其中 uidef 中定义的 init.xml 用来定义 SOUI 中使用的全局 UI 定义。 这个文件一般应该在 main 函数中被 SApplication 对象使用，如：</p> <div class=highlight><pre><span></span><code><span class=c1>//... </span>
<span class=c1>//定义一个唯一的 SApplication 对象，SApplication 管理整个应用程序的资源</span>
<span class=n>SApplication</span><span class=w> </span><span class=o>*</span><span class=n>theApp</span><span class=o>=</span><span class=k>new</span><span class=w> </span><span class=n>SApplication</span><span class=p>(</span><span class=n>pRenderFactory</span><span class=p>,</span><span class=n>hInstance</span><span class=p>);</span><span class=w></span>
<span class=c1>//... </span>
<span class=c1>//加载全局资源描述 XML</span>
<span class=n>theApp</span><span class=o>-&gt;</span><span class=n>Init</span><span class=p>(</span><span class=n>_T</span><span class=p>(</span><span class=s>&quot;xml_init&quot;</span><span class=p>));</span><span class=w></span>
</code></pre></div> <p>这里直接使用 uidef 中定义的 name 属性来初始化系统。SApplication::Init 默认从 uidef 段中去查找 xml_init 资源，当然也可以定义在其它资源类型如 xml 中，但是需要在 init 中 显示指定资源类型。 下面我们打开 xml\init.xml 看一下里面的内容：</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;UIDEF&gt;</span>
 <span class=nt>&lt;font</span> <span class=na>face=</span><span class=s>&quot;微软雅黑&quot;</span> <span class=na>size=</span><span class=s>&quot;18&quot;</span><span class=nt>/&gt;</span> 
 <span class=nt>&lt;string&gt;</span>
 <span class=nt>&lt;ver</span> <span class=na>value=</span><span class=s>&quot;1.0&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/string&gt;</span> 
 <span class=nt>&lt;skin&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_page_icons&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_page_icons&quot;</span> <span class=na>states=</span><span class=s>&quot;9&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_small_icons&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_small_icons&quot;</span> <span class=na>states=</span><span class=s>&quot;12&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_tree_icon&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_treeicon&quot;</span> <span class=na>states=</span><span class=s>&quot;3&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_menuicon&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_small_icons&quot;</span> <span class=na>states=</span><span class=s>&quot;12&quot;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;border</span> <span class=na>name=</span><span class=s>&quot;skin_menuborder&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_menu_border&quot;</span> <span class=na>left=</span><span class=s>&quot;2&quot;</span> 
<span class=na>top=</span><span class=s>&quot;2&quot;</span> <span class=na>border=</span><span class=s>&quot;2,2,2,2&quot;</span> <span class=na>key=</span><span class=s>&quot;FF00FF&quot;</span> <span class=na>alpha=</span><span class=s>&quot;100&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_webbtn_back&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:webbtn_back&quot;</span> <span class=na>states=</span><span class=s>&quot;4&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_webbtn_forward&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:webbtn_forward&quot;</span> 
<span class=na>states=</span><span class=s>&quot;4&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_webbtn_refresh&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:webbtn_refresh&quot;</span> 
<span class=na>states=</span><span class=s>&quot;4&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_tab_left&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_tab_left&quot;</span> <span class=na>states=</span><span class=s>&quot;3&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_tab_left_splitter&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_tab_left_splitter&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_tab_main&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:png_tab_main&quot;</span> <span class=na>states=</span><span class=s>&quot;3&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>&quot;skin_btn_menu&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:btn_menu&quot;</span> <span class=na>states=</span><span class=s>&quot;3&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;gif</span> <span class=na>name=</span><span class=s>&quot;gif_horse&quot;</span> <span class=na>src=</span><span class=s>&quot;gif:gif_horse&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;gif</span> <span class=na>name=</span><span class=s>&quot;gif_penguin&quot;</span> <span class=na>src=</span><span class=s>&quot;gif:gif_penguin&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/skin&gt;</span>
 <span class=nt>&lt;style&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_dlg_frame&quot;</span> <span class=na>skin=</span><span class=s>&quot;_skin.sys.wnd.bkgnd&quot;</span> <span class=na>font=</span><span class=s>&quot;&quot;</span> 
<span class=na>colorText=</span><span class=s>&quot;#000000&quot;</span> <span class=na>margin-x=</span><span class=s>&quot;0&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_btn_link&quot;</span> <span class=na>cursor=</span><span class=s>&quot;hand&quot;</span> <span class=na>colorHover=</span><span class=s>&quot;#0A84D2&quot;</span> <span class=nt>/&gt;</span>
 <span class=c>&lt;!--定义文字按钮的样式--&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_btn_weblink&quot;</span> <span class=na>cursor=</span><span class=s>&quot;hand&quot;</span> <span class=na>colorText=</span><span class=s>&quot;#1e78d5&quot;</span> 
<span class=na>colorHover=</span><span class=s>&quot;#1e78d5&quot;</span> <span class=na>font=</span><span class=s>&quot;italic:1&quot;</span> <span class=na>fontHover=</span><span class=s>&quot;underline:1,italic:1&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_txt_red&quot;</span> <span class=na>font=</span><span class=s>&quot;face:宋体,bold:1&quot;</span> <span class=na>colorText=</span><span class=s>&quot;#FF0000&quot;</span> 
<span class=nt>/&gt;</span>
 <span class=c>&lt;!--定义白色粗体宋体--&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_txt_black&quot;</span> <span class=na>font=</span><span class=s>&quot;face:宋体,bold:1&quot;</span> <span class=na>colorText=</span><span class=s>&quot;#000000&quot;</span> 
<span class=nt>/&gt;</span>
 <span class=c>&lt;!--定义黑色粗体宋体--&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_txt_white&quot;</span> <span class=na>font=</span><span class=s>&quot;face:宋体,bold:1&quot;</span> <span class=na>colorText=</span><span class=s>&quot;#FFFFFF&quot;</span> 
<span class=nt>/&gt;</span>
 <span class=c>&lt;!--定义白色粗体宋体--&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;normalbtn&quot;</span> <span class=na>font=</span><span class=s>&quot;&quot;</span> <span class=na>colorText=</span><span class=s>&quot;#385e8b&quot;</span> 
<span class=na>colorTextDisable=</span><span class=s>&quot;#91a7c0&quot;</span> <span class=na>textMode=</span><span class=s>&quot;25&quot;</span> <span class=na>cursor=</span><span class=s>&quot;hand&quot;</span> <span class=na>margin-x=</span><span class=s>&quot;0&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;toptext&quot;</span> <span class=na>textMode=</span><span class=s>&quot;20&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;vcentertext&quot;</span> <span class=na>textMode=</span><span class=s>&quot;24&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;rightvcentertext&quot;</span> <span class=na>textMode=</span><span class=s>&quot;26&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;centertext&quot;</span> <span class=na>textMode=</span><span class=s>&quot;25&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;righttext&quot;</span> <span class=na>textMode=</span><span class=s>&quot;22&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;linkimage&quot;</span> <span class=na>cursor=</span><span class=s>&quot;hand&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_edit&quot;</span> <span class=na>ncSkin=</span><span class=s>&quot;_skin.sys.border&quot;</span> <span class=na>margin-x=</span><span class=s>&quot;2&quot;</span> <span class=na>marginy=</span><span class=s>&quot;2&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/style&gt;</span>
 <span class=nt>&lt;objattr&gt;</span>
 <span class=nt>&lt;button</span> <span class=na>class=</span><span class=s>&quot;normalbtn&quot;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;imgbtn</span> <span class=na>class=</span><span class=s>&quot;linkimage&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;tabctrl</span> <span class=na>colorText=</span><span class=s>&quot;000000&quot;</span> <span class=na>align=</span><span class=s>&quot;top&quot;</span> <span class=na>tabWidth=</span><span class=s>&quot;70&quot;</span> <span class=na>tabHeight=</span><span class=s>&quot;38&quot;</span> 
<span class=na>tabSpacing=</span><span class=s>&quot;0&quot;</span> <span class=na>tabPos=</span><span class=s>&quot;10&quot;</span> <span class=na>dotted=</span><span class=s>&quot;1&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;edit</span> <span class=na>transParent=</span><span class=s>&quot;1&quot;</span> <span class=na>margin-x=</span><span class=s>&quot;2&quot;</span> <span class=na>margin-y=</span><span class=s>&quot;2&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;treectrl</span> <span class=na>colorItemBkgnd=</span><span class=s>&quot;#FFFFFF&quot;</span> <span class=na>colorItemSelBkgnd=</span><span class=s>&quot;#000088&quot;</span> 
<span class=na>colorItemText=</span><span class=s>&quot;#000000&quot;</span> <span class=na>colorItemSelText=</span><span class=s>&quot;#FFFFFF&quot;</span> <span class=na>indent=</span><span class=s>&quot;17&quot;</span> 
<span class=na>itemMargin=</span><span class=s>&quot;4&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/objattr&gt;</span>
<span class=nt>&lt;/UIDEF&gt;</span>
</code></pre></div> <p>这个 xml_init 必须是以 UIDEF 为唯一根节点。 在 UIDEF 下，可以定义 font，string，skins，style，objattr 五个子节点。 其中，font 定义 SOUI 中使用的默认字体，只有 face 和 size 两个属性。 string 是一个字符串表，定义一个"name-字符串"映射，在布局的 XML 文件中可以通过 引用字符串的 name 来获得字符串。 skins 定义 SOUI 中使用的全局窗口元素绘制对象，每一个对象都对应一个 SOUI::ISkinObj 的派生类。 SOUI 系统默认实现了 SSkinImgList(imglist), SSkinImgFrame(imgframe), SSkinButton(button), SSkinGradation(gradation), SSkinScrollbar(scrollbar), SSkinMenuBorder(border)这六种绘图类型。SSkinImgList 为 SOUI 中的 C++类名， imglist 为在 skins 节点中的元素类型名。 下面分别介绍这几种绘图类型： 1、imglist imglist 是一个图片序列对象，可以包含一组小图片，常见的如按钮需要使用的 4 种状态 图。</p> <p>imglist 包含 4 个属性：</p> <div class=highlight><pre><span></span><code><span class=n>SOUI_ATTRS_BEGIN</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_CUSTOM</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;src&quot;</span><span class=p>,</span><span class=w> </span><span class=n>OnAttrImage</span><span class=p>)</span><span class=w> </span>
<span class=c1>//skinObj 引用的图片文件定义在 uires.idx 中的 name 属性。</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;tile&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_bTile</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//绘制是否平铺,0--位伸（默认），其它--平铺</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;vertical&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_bVertical</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w></span>
<span class=c1>//子图是否垂直排列，0--水平排列(默认), 其它--垂直排列</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;states&quot;</span><span class=p>,</span><span class=n>m_nStates</span><span class=p>,</span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//子图数量,默认为 1</span>
<span class=w> </span><span class=n>SOUI_ATTRS_END</span><span class=p>()</span><span class=w></span>
</code></pre></div> <p>假定上图的图片在 uires.idx 中的定义为：</p> <div class=highlight><pre><span></span><code> <span class=nt>&lt;imgx&gt;</span>
 <span class=nt>&lt;file</span> <span class=na>name=</span><span class=s>&#39;btn_next&#39;</span> <span class=na>file=</span><span class=s>&#39;image\btn.next.png&#39;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;/imgx&gt;</span>
</code></pre></div> <p>要在 soui 中引用这个图片，需要在 init.xml 的 skins 结节中做如下声明：</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;skins&gt;</span>
<span class=nt>&lt;imglist</span> <span class=na>name=</span><span class=s>“skin_btn_next&quot;</span> <span class=na>src=</span><span class=s>&quot;imgx:btn_next&quot;</span> <span class=na>states=</span><span class=s>&quot;4&quot;</span> <span class=na>tile=</span><span class=s>&quot;0&quot;</span> 
<span class=na>vertical=</span><span class=s>&quot;0&quot;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;/skins&gt;</span>
</code></pre></div> <p>在上面的 skin 定义中， name 属性告诉系统如何引用定义的 imglist src 属性定义该 skin 需要使用哪一个图片资源，资源引用格式为 type:name，如上面使用 的 imgx:btn_next，对于图片资源，通常情况下也可以不指定 type,系统会自动在常用的 图片类型下查找，但不建议这样使用。 states 定义图中包含多少个子图。 title 定义图片在放大显示时时平铺还是拉伸，默认为拉伸。 vertical 属性定义图中的子图的排列方式。 在本例子中 tile 和 vertical 属性都可以不指定。</p> <p>2、imgframe</p> <p>imgframe 是一个提供九宫格显示的绘图对象，SSkinImgFrame 派生自 SSkinImgList， 因此 imgframe 也拥有 imglist 的全部属性。 此外，imgframe 提供了几个新的属性：</p> <div class=highlight><pre><span></span><code><span class=n>SOUI_ATTRS_BEGIN</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;left&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>left</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//九宫格左边距</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;top&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>top</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//九宫格上边距</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;right&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>right</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//九宫格右边距</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;bottom&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>bottom</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//九宫格下边距</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;margin-x&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>left</span><span class=o>=</span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>right</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w></span>
<span class=c1>//九宫格左右边距</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;margin-y&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>top</span><span class=o>=</span><span class=n>m_rcMargin</span><span class=p>.</span><span class=n>bottom</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w></span>
<span class=c1>//九宫格上下边距</span>
<span class=n>SOUI_ATTRS_END</span><span class=p>()</span><span class=w></span>
</code></pre></div> <p>imgframe 的格式如上图，在 imgframe 中通过 left, top, right, bottom 来定义九宫格。 3、button button 绘图对象是绘制按钮时使用的，它使用渐变实现绘制按钮的 4 种状态。 包含以下属性：</p> <div class=highlight><pre><span></span><code><span class=n>SOUI_ATTRS_BEGIN</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorBorder&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crBorder</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//边框颜色</span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorUp&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crUp</span><span class=p>[</span><span class=n>ST_NORMAL</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//正常状态渐变</span>
<span class=err>起始颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorDown&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crDown</span><span class=p>[</span><span class=n>ST_NORMAL</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//正常状态渐</span>
<span class=err>变终止颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorUpHover&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crUp</span><span class=p>[</span><span class=n>ST_HOVER</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//浮动状态渐</span>
<span class=err>变起始颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorDownHover&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crDown</span><span class=p>[</span><span class=n>ST_HOVER</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//浮动状态渐</span>
<span class=err>变终止颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorUpPush&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crUp</span><span class=p>[</span><span class=n>ST_PUSHDOWN</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//下压状态渐</span>
<span class=err>变起始颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorDownPush&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crDown</span><span class=p>[</span><span class=n>ST_PUSHDOWN</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//下压状态渐</span>
<span class=err>变终止颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorUpDisable&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crUp</span><span class=p>[</span><span class=n>ST_DISABLE</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//禁用状态渐</span>
<span class=err>变起始颜色</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorDownDisable&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crDown</span><span class=p>[</span><span class=n>ST_DISABLE</span><span class=p>],</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//禁用状态</span>
<span class=err>渐变终止颜色</span><span class=w></span>
<span class=n>SOUI_ATTRS_END</span><span class=p>()</span><span class=w></span>
</code></pre></div> <p>4、gradation 渐变绘图对象，提供 3 个属性：</p> <div class=highlight><pre><span></span><code><span class=n>SOUI_ATTRS_BEGIN</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorFrom&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crFrom</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//渐变起始颜色</span>
<span class=w> </span><span class=n>ATTR_COLOR</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;colorTo&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_crTo</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//渐变终止颜色</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;vertical&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m_bVert</span><span class=p>,</span><span class=w> </span><span class=n>TRUE</span><span class=p>)</span><span class=w> </span><span class=c1>//渐变方向,0--水平(默认), 1--</span>
<span class=err>垂直</span><span class=w></span>
<span class=w> </span><span class=n>SOUI_ATTRS_END</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=err>```</span><span class=w></span>

<span class=mi>5</span><span class=err>、</span><span class=n>scrollbar</span><span class=w></span>

<span class=err>滚动条皮肤，虽然它派生自</span><span class=w> </span><span class=n>imglist</span><span class=err>，实际上</span><span class=w> </span><span class=n>imglist</span><span class=w> </span><span class=err>中实现的属性在</span><span class=w> </span><span class=n>scrollbar</span><span class=w> </span><span class=err>中没有意</span><span class=w></span>
<span class=err>义，只是为了省点代码。</span><span class=w></span>

<span class=err>```</span><span class=n>cpp</span><span class=w></span>
<span class=n>SOUI_ATTRS_BEGIN</span><span class=p>()</span><span class=w></span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;margin&quot;</span><span class=p>,</span><span class=n>m_nMargin</span><span class=p>,</span><span class=n>FALSE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//边缘不拉伸大小</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;hasGripper&quot;</span><span class=p>,</span><span class=n>m_bHasGripper</span><span class=p>,</span><span class=n>FALSE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//滑块上是否有帮手(gripper)</span>
<span class=w> </span><span class=n>ATTR_INT</span><span class=p>(</span><span class=sa>L</span><span class=s>&quot;hasInactive&quot;</span><span class=p>,</span><span class=n>m_bHasInactive</span><span class=p>,</span><span class=n>FALSE</span><span class=p>)</span><span class=w> </span>
<span class=c1>//是否有禁用态</span>
<span class=w> </span><span class=n>SOUI_ATTRS_END</span><span class=p>()</span><span class=w></span>
</code></pre></div> <p>一般的 scrollbar 皮肤资源如下： 如果没有帮手也没有禁用状态，图片应该是 8*3 的正方形网格。 有帮手则 X 增加一个网格，有禁用状态则 Y 增加一个网格。 6、border 给 menu 用的，以后再介绍。 style 在 style 节点中，定义 UI 布局中 SOUI 窗口对象的属性集合，它们是 SWindow 对象的属 性，所有 SWindow 对象都可以通过 class 属性来引用 style 节点中定义的属性集合。 objattr 控件的默认属性。 SOUI 可以为每一类 UI 控件通过 objattr 来提供一种默认属性集合，以减少在 XML 布局 中的重复定义。 4.1.2 布局(layout)资源文件 窗口布局的概念 每一个 UI 都是由大量的界面元素构成的，在 Windows 编程，这些界面元素的最小单位通 常称之为控件。 布局就是这些控件在主界面上的大小及相对位置。 传统的布局一般使用一个 4 个绝对坐标来定义一个控件在主窗口的位置。对于窗口是固定 大小的界面来说，这种方式是最简单有效的.</p> <p>然而问题在于在 Windows 系统上编程，基本上很少有程序的窗口是固定大小的，用户希 望它的窗口能够随时调整大小。调整大小后界面里的控件还能够按照一定的规则进行重 排。 我自己最讨厌的就是在 WM_SIZE 里重排控件位置。 随着使用 XML 来描述控件布局方式的出现，这种窗口布局过程中的窗口重排才得到了根 本的解决。 两种 XML 布局类型 目前流行的 UI 库基本都是采用 XML 来描述窗口布局，如 Android, WPF, QQ 等。 使用 XML 布局整体上可以划分为两种类型：锚点布局和流式布局。 所谓流式布局就是一个控件只描述控件的大小，而不关心位置，它的最终显示位置由布局 器计算出来，如 Android 及 DuiLib 里实现的 VerticalLayout 及 HorizontalLayout 等。 锚点布局和流式布局不同在于，它具体的定义一个控件的 4 个点的坐标位置，但这些位置 通常不是绝对位置，而是一个相对于父窗口不同锚点的位置，当父窗口大小改变时，子窗 口也会根据锚点的位置变化自动调整。布局的人使用锚点布局时很清楚一个控件最终会显 示在哪，不需要很强的想象能力。 两种布局都有它们的优点，完善的 UI 布局器通常会同时提供两种布局能力。 考虑到锚点布局更直观，而且功能上完全可以解决布局需求，为了简化设计，在 SOUI 中 只提供锚点布局。 SOUI 布局范例及解析 下面 XML 为 soui-demo 的主界面布局文件。</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;SOUI</span> <span class=na>name=</span><span class=s>&quot;dlg_main&quot;</span> <span class=na>title=</span><span class=s>&quot;SOUI-DEMO version:%ver%&quot;</span> <span class=na>bigIcon=</span><span class=s>&quot;LOGO:32&quot;</span> 
<span class=na>smallIcon=</span><span class=s>&quot;LOGO:16&quot;</span> <span class=na>width=</span><span class=s>&quot;600&quot;</span> <span class=na>height=</span><span class=s>&quot;400&quot;</span> <span class=na>appWnd=</span><span class=s>&quot;1&quot;</span> <span class=na>margin=</span><span class=s>&quot;5,5,5,5&quot;</span> 
<span class=na>resizable=</span><span class=s>&quot;1&quot;</span> <span class=na>translucent=</span><span class=s>&quot;1&quot;</span> <span class=nt>&gt;</span>
 <span class=nt>&lt;skin&gt;</span>
 <span class=c>&lt;!--局部 skin 对象--&gt;</span>
 <span class=nt>&lt;gif</span> <span class=na>name=</span><span class=s>&quot;gif_horse&quot;</span> <span class=na>src=</span><span class=s>&quot;gif:gif_horse&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;gif</span> <span class=na>name=</span><span class=s>&quot;gif_penguin&quot;</span> <span class=na>src=</span><span class=s>&quot;gif:gif_penguin&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/skin&gt;</span>
 <span class=nt>&lt;style&gt;</span>
 <span class=c>&lt;!--局部 style 对象--&gt;</span>
 <span class=nt>&lt;class</span> <span class=na>name=</span><span class=s>&quot;cls_edit&quot;</span> <span class=na>ncSkin=</span><span class=s>&quot;_skin.sys.border&quot;</span> <span class=na>margin-x=</span><span class=s>&quot;2&quot;</span> <span class=na>marginy=</span><span class=s>&quot;2&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;/style&gt;</span>
 <span class=nt>&lt;root</span> <span class=na>class=</span><span class=s>&quot;cls_dlg_frame&quot;</span> <span class=na>cache=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;caption</span> <span class=na>pos=</span><span class=s>&quot;0,0,-0,30&quot;</span> <span class=na>show=</span><span class=s>&quot;1&quot;</span> <span class=na>font=</span><span class=s>&quot;adding:8&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;icon</span> <span class=na>pos=</span><span class=s>&quot;10,8&quot;</span> <span class=na>src=</span><span class=s>&quot;LOGO:16&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>class=</span><span class=s>&quot;cls_txt_red&quot;</span><span class=nt>&gt;</span>SOUI-DEMO version:%ver%<span class=nt>&lt;/text&gt;</span>
<span class=nt>&lt;imgbtn</span> <span class=na>id=</span><span class=s>&quot;1&quot;</span> <span class=na>skin=</span><span class=s>&quot;_skin.sys.btn.close&quot;</span> <span class=na>pos=</span><span class=s>&quot;-45,0&quot;</span> <span class=na>tip=</span><span class=s>&quot;close&quot;</span> 
<span class=na>animate=</span><span class=s>&quot;1&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;imgbtn</span> <span class=na>id=</span><span class=s>&quot;2&quot;</span> <span class=na>skin=</span><span class=s>&quot;_skin.sys.btn.maximize&quot;</span> <span class=na>pos=</span><span class=s>&quot;-83,0&quot;</span> <span class=na>animate=</span><span class=s>&quot;1&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;imgbtn</span> <span class=na>id=</span><span class=s>&quot;3&quot;</span> <span class=na>skin=</span><span class=s>&quot;_skin.sys.btn.restore&quot;</span> <span class=na>pos=</span><span class=s>&quot;-83,0&quot;</span> <span class=na>show=</span><span class=s>&quot;0&quot;</span> 
<span class=na>animate=</span><span class=s>&quot;1&quot;</span> <span class=nt>/&gt;</span>
 <span class=nt>&lt;imgbtn</span> <span class=na>id=</span><span class=s>&quot;5&quot;</span> <span class=na>skin=</span><span class=s>&quot;_skin.sys.btn.minimize&quot;</span> <span class=na>pos=</span><span class=s>&quot;-121,0&quot;</span> <span class=na>animate=</span><span class=s>&quot;1&quot;</span> 
<span class=nt>/&gt;</span>
 <span class=nt>&lt;imgbtn</span> <span class=na>name=</span><span class=s>&quot;btn_menu&quot;</span> <span class=na>skin=</span><span class=s>&quot;skin_btn_menu&quot;</span> <span class=na>pos=</span><span class=s>&quot;-151,2&quot;</span> <span class=na>animate=</span><span class=s>&quot;1&quot;</span> 
<span class=nt>/&gt;</span>
 <span class=nt>&lt;/caption&gt;</span>
 <span class=nt>&lt;tabctrl</span> <span class=na>name=</span><span class=s>&quot;tab_main&quot;</span> <span class=na>pos=</span><span class=s>&quot;5,30,-5,-5&quot;</span> <span class=na>show=</span><span class=s>&quot;1&quot;</span> <span class=na>curSel=</span><span class=s>&quot;0&quot;</span> 
<span class=na>focusable=</span><span class=s>&quot;0&quot;</span> <span class=na>animateSteps=</span><span class=s>&quot;10&quot;</span> <span class=na>tabHeight=</span><span class=s>&quot;75&quot;</span> <span class=na>tabSkin=</span><span class=s>&quot;skin_tab_main&quot;</span> <span class=na>texty=</span><span class=s>&quot;50&quot;</span> <span class=na>iconSkin=</span><span class=s>&quot;skin_page_icons&quot;</span> <span class=na>icon-x=</span><span class=s>&quot;10&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;listctrl123&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;listctrl</span> <span class=na>name=</span><span class=s>&quot;lc_test&quot;</span> <span class=na>pos=</span><span class=s>&quot;10,0,-10,-10&quot;</span> <span class=na>itemHeight=</span><span class=s>&quot;20&quot;</span> 
<span class=na>headerHeight=</span><span class=s>&quot;30&quot;</span> <span class=na>cache=</span><span class=s>&quot;1&quot;</span> <span class=na>cursor=</span><span class=s>&quot;CUR_TST&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;header</span> <span class=na>align=</span><span class=s>&quot;left&quot;</span> <span class=na>itemSwapEnable=</span><span class=s>&quot;1&quot;</span> <span class=na>fixWidth=</span><span class=s>&quot;0&quot;</span> <span class=na>sortHeader=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;items&gt;</span>
 <span class=nt>&lt;item</span> <span class=na>width=</span><span class=s>&quot;150&quot;</span><span class=nt>&gt;</span>name<span class=nt>&lt;/item&gt;</span>
 <span class=nt>&lt;item</span> <span class=na>width=</span><span class=s>&quot;150&quot;</span><span class=nt>&gt;</span>gender<span class=nt>&lt;/item&gt;</span>
 <span class=nt>&lt;item</span> <span class=na>width=</span><span class=s>&quot;150&quot;</span><span class=nt>&gt;</span>age<span class=nt>&lt;/item&gt;</span>
 <span class=nt>&lt;item</span> <span class=na>width=</span><span class=s>&quot;150&quot;</span><span class=nt>&gt;</span>score<span class=nt>&lt;/item&gt;</span>
 <span class=nt>&lt;/items&gt;</span>
 <span class=nt>&lt;/header&gt;</span>
 <span class=nt>&lt;/listctrl&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;webkit&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_webkit&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;flash&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;flash</span> <span class=na>pos=</span><span class=s>&quot;0,0,-0,-0&quot;</span> <span class=na>name=</span><span class=s>&quot;ctrl_flash&quot;</span> 
<span class=na>url=</span><span class=s>&quot;http://swf.sc.chinaz.com//Files//DownLoad//flash2//201401//flash2524.sw</span>
<span class=s>f&quot;</span> <span class=na>delay=</span><span class=s>&quot;1&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;gif&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;gifplayer</span> <span class=na>pos=</span><span class=s>&quot;10,10&quot;</span> <span class=na>skin=</span><span class=s>&quot;gif_horse&quot;</span> <span class=na>name=</span><span class=s>&quot;giftest&quot;</span> 
<span class=na>cursor=</span><span class=s>&quot;ANI_ARROW&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;button</span> <span class=na>width=</span><span class=s>&quot;250&quot;</span> <span class=na>height=</span><span class=s>&quot;30&quot;</span> <span class=na>name=</span><span class=s>&quot;btnSelectGif&quot;</span><span class=nt>&gt;</span>load gif 
file<span class=nt>&lt;/button&gt;</span>
 <span class=nt>&lt;gifplayer</span> <span class=na>pos=</span><span class=s>&quot;10,150&quot;</span> <span class=na>skin=</span><span class=s>&quot;gif_penguin&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;icon</span> <span class=na>pos=</span><span class=s>&quot;10,300&quot;</span> <span class=na>src=</span><span class=s>&quot;LOGO:64&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;layout&quot;</span><span class=nt>&gt;</span>
<span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_layout&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;treebox&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_treebox&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title =</span><span class=s>&quot;misc.&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_misc&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;treectrl&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_treectrl&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;page</span> <span class=na>title=</span><span class=s>&quot;about&quot;</span><span class=nt>&gt;</span>
 <span class=nt>&lt;include</span> <span class=na>src=</span><span class=s>&quot;layout:page_about&quot;</span><span class=nt>/&gt;</span>
 <span class=nt>&lt;/page&gt;</span>
 <span class=nt>&lt;/tabctrl&gt;</span>
 <span class=nt>&lt;/root&gt;</span>
<span class=nt>&lt;/SOUI&gt;</span>
</code></pre></div> <p>可以看到在这个 XML 中，有一个根节点：SOUI。在根节点中，定义了主界面的真窗口的 各种属性（属性的含义见后续篇）。 在根节点下有 3 个节点，分别是 skin, style 及 root。 skin, 和 style 和前一篇讲的 init.xml 的功能一样。不同在于在布局文件中定义的 skin 及 style 只在当前窗口的生命周期期间有效，类似于 C++函数中的局部变量，窗口关闭后这 些对象会自动析构。我称之为局部 skin 及局部 style。 窗口中控件的布局信息定义在 root 节点中。 root 节点本身也是一个 SWindow 窗口对象，但是在这里必须是"root"才能识别，在这个 节点中可以有 SWindow 的各种属性，但是和布局位置相关的属性自动无效，因为该窗口 总是充满整个宿主窗口。 在 root 节点下可以按照不同的布局层次采用锚点布局方式布局各种系统内置控件及用户自 定义控件。 在 demo 中，我首先在最上面布局一个 caption 控件，caption 控件里又有各种标题，按 钮等子控件。 然后在下面布局一个 tabctrl 以及它的子控件。 在这个布局 XML 中有大量的控件属性定义。不同的控件有不同的属性，这里不详细展 开，这里主要关注一下 page 节点下的 include 节点。 include 只有一个属性：src，src 定义如何去引用在另一个 XML 文件中定义的布局 XML，如“layout:page_layout”代表这里要引用在 layout 资源类型中定义的 name 为 page_layout 的 XML 文件（关于资源的定义参考第四篇）。 下面是 layout:page_layout 指向的 XML 文件的内容：</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;include&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>pos=</span><span class=s>&quot;100,10&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;center&quot;</span><span class=nt>&gt;</span>center align1<span class=nt>&lt;/text&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>pos=</span><span class=s>&quot;100,30&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;center&quot;</span><span class=nt>&gt;</span>center align align<span class=nt>&lt;/text&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>pos=</span><span class=s>&quot;250,50&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;rightTop&quot;</span><span class=nt>&gt;</span>align right top<span class=nt>&lt;/text&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>pos=</span><span class=s>&quot;250,70&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;rightTop&quot;</span><span class=nt>&gt;</span>align right top 2<span class=nt>&lt;/text&gt;</span>
 <span class=nt>&lt;check</span> <span class=na>pos=</span><span class=s>&quot;250,90&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;rightTop&quot;</span><span class=nt>&gt;</span>check right top<span class=nt>&lt;/check&gt;</span>
 <span class=nt>&lt;check</span> <span class=na>pos=</span><span class=s>&quot;250,110&quot;</span> <span class=na>pos2type=</span><span class=s>&quot;rightTop&quot;</span> <span class=na>font=</span><span class=s>&quot;adding:-5&quot;</span><span class=nt>&gt;</span>check right 
top1235<span class=nt>&lt;/check&gt;</span>
 <span class=nt>&lt;text</span> <span class=na>pos=</span><span class=s>&quot;250,130&quot;</span> <span class=na>class=</span><span class=s>&quot;cls_txt_red&quot;</span><span class=nt>&gt;</span>text left top<span class=nt>&lt;/text&gt;</span>
 <span class=nt>&lt;button</span> <span class=na>pos=</span><span class=s>&quot;10,150,@150,@30&quot;</span><span class=nt>&gt;</span>button 1 using @<span class=nt>&lt;/button&gt;</span>
 <span class=nt>&lt;button</span> <span class=na>pos=</span><span class=s>&quot;10,200&quot;</span> <span class=na>width=</span><span class=s>&quot;150&quot;</span> <span class=na>height=</span><span class=s>&quot;30&quot;</span><span class=nt>&gt;</span>button 1 using width<span class=nt>&lt;/button&gt;</span>
 <span class=nt>&lt;button</span> <span class=na>name=</span><span class=s>&quot;btn_hidetst&quot;</span> <span class=na>pos=</span><span class=s>&quot;300,150,@100,@30&quot;</span> <span class=na>display=</span><span class=s>&quot;0&quot;</span> <span class=na>tip=</span><span class=s>&quot;click me </span>
<span class=s>to hide me and see how the next image will move&quot;</span><span class=nt>&gt;</span>hide test<span class=nt>&lt;/button&gt;</span>
 <span class=nt>&lt;img</span> <span class=na>skin=</span><span class=s>&quot;skin_page_icons&quot;</span> <span class=na>iconIndex=</span><span class=s>&quot;1&quot;</span> <span class=na>pos=</span><span class=s>&quot;[5,150,-10,-10&quot;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/include&gt;</span>
</code></pre></div> <p>可以看到在这个文件中，有一个以"include"的根节点，在 include 节点下才是布局 XML。 这里的 include 代表该文件只能是被其它的有 include 元素的布局文件引用。 需要注意的是，在 include 的 XML 文件中不能定义局部 skin 及局部 style。 SOUI 的锚点布局 SOUI 布局全部采用相对坐标，由 pos,offset(pos2type), size, width,height 这几个个窗 口属性配合指定。 size, width, height 属性 size, width, height 比较简单，是用来指定窗口的大小的，只有在 pos 属性指定的值个数 不为 4 时生效。 size 是 2014 年底增加的布局属性，size="width,height"。 width, height 可以有 3 种值：full,-1,非负整数。 为 full 时，代表高度或者宽度和父窗口的客户区大小相等。 -1 代表根据窗口内容自动计算窗口大小。 非负整数直接指定窗口大小。 在图片控件中，控件是指定的皮肤默认大小。 在文本控件中，还可以指定一个 maxWidth 属性，控件是文本内容的大小，但宽度不超过 maxWidth。 pos 属性 pos 属性可以指定 4 个值，也可以指定 2 个值。指定 4 个值时，分别代表控件的 left,top,right,bottom,指定两个值时代表控件的 x,y，具体位置还依赖于另外 3 个参数。 指定 4 个值时，pos 目前支持 7 种标志：|,%,[,],{,},@ “|”代表参考父窗口的中心；如|-10 代表在父窗口的中心向左/上偏移 10 象素。 “%”代表在父窗口的百分比，可以是小数，负数。如：%40 代表在父窗口的 40%位 置，%-40 则等价于(1-40%)。 “[”相对于前一兄弟窗口。用于 X 时，参考前一兄弟窗口的 right，用于 Y 时参考前一兄 弟窗口的 bottom “]”相对于后一兄弟窗口。用于 X 时，参考后一兄弟的 left,用于 Y 时参考后一兄弟的 top “{”相对于前一兄弟窗口。用于 X 时，参考前一兄弟窗口的 left，用于 Y 时参考前一兄弟 窗口的 top “}”相对于后一兄弟窗口。用于 X 时，参考后一兄弟的 right,用于 Y 时参考后一兄弟的 bottom “@”标志用来指定窗口的大小，只能出现在 pos 属性的第 3，4 个值中，用来标识窗口 的宽度。当后面的值为负时，代表自动计算窗口的宽度或者高度（2015.3.3 新增加解 释）。 注：“|“, "[" ,"]", "{", "}" 中指定的值都可以为正或者负，正时向右或者下偏移，负则向 左或者上偏移。 当没有上述标志时，负号代表参考父窗口的右边或者下边缩进绝对值位置。如： pos="0,0,-0,-0"代表占满父窗口。而 pos="10,10,-10,-10"则代表在父窗口的基础上向内 全部缩进 10 点。 @:指定窗口的 size。只能用于 x2,y2，用于 x2 时，指定窗口的 width，用于 y2 时指定窗 口的 height。注：只能为正值，负号会自动忽略。 其中“{”和“}”是 SOUI 在 DUIENGINE 的基础上新增加的布局标志（SOUI 是在 DUIENGINE 的基础上全面重构而来）。 注意!!!由于系统运行向前及向后引用，理论上有可能出来循环引用，导致界面布局失败， 因此在使用"["，"{"，“}” 和"]"这几个标志时需要特别注意。 当 pos 只指定了 x1,y1 时，通常需要和 offset(或者 pos2type),size(或者 width,height)配 合使用。 offset 及 pos2type 属性 offset 属性包含两个值，用来代表窗口在通过其它布局属性完成后的偏移量：如 offset="-1,-1"，该 offset 表明窗口向左方及上方各平衡一个窗口大小的单位。 offset 及 pos2type 属性具体请参考《第十六篇：SWindow 的布局属性 pos2type 及 offset》 在 SOUI 的布局系统中，使用一个 pos 属性基本可以完整 90％以上的布局功能，建议用 户在 demo 中修改各种布局属性来观察控件位置的变化以加深对 SOUI 布局系统的理解。</p> <p>4.1.3 布局属性 pos2type 及 offset 当窗口大小需要根据内容来确定时，使用 XML 布局可能需要做一些特殊的处理。 例如：不管窗口多大，我需要将该窗口相对于父窗口居中在 XML 中应该怎么处理？ 如果窗口大小是固定的（如, 100 *100)，这样 pos 属性可以定义为"|-50,|-50,|-50,|-50"即 可。 当窗口大小不确定时，SOUI 中提供了 pos2type 及 offset 来协同处理。 其中 pos2type 是 offset 的子集。 下面先重点介绍 offset 属性 offset 属性是 SOUI 在通过 pos 属性完成坐标定位后再将坐标进行偏移的属性。和 pos 中 一般使用象素为单位不同，offset 是以控件最后的大小为单位进行平移。 我们可以在 XML 中或者代码中使用 offset = "-0.5,-0.5"这样的形式来描述窗口的坐标平 移属性。 属性中包含两个值，分别对应 X，Y 方向的平移相对于窗口大小的倍数，一般为[-1,0]的小 数(float)，当然也可以超过这个范围。 我们先看一下代码中如何实现：</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>SOUI_EXP</span><span class=w> </span><span class=n>SwndLayout</span><span class=w></span>
<span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w> </span><span class=k>public</span><span class=o>:</span><span class=w></span>
<span class=w> </span><span class=c1>//... </span>
<span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>fOffsetX</span><span class=p>,</span><span class=n>fOffsetY</span><span class=p>;</span><span class=w> </span><span class=cm>/**&lt; 窗口坐标偏移量, x += fOffsetX * </span>
<span class=cm> //...</span>
<span class=cm> };</span>
<span class=cm> ```</span>

<span class=cm> ```cpp</span>
<span class=cm> int SwndLayout::CalcPosition(LPRECT lpRcContainer,CRect &amp;rcWindow )</span>
<span class=cm> {</span>
<span class=cm> int nRet=0;</span>
<span class=cm> //...</span>
<span class=cm> if(nRet==0)</span>
<span class=cm> {//没有坐标等待计算了</span>
<span class=cm> rcWindow.NormalizeRect();</span>
<span class=cm> //处理窗口的偏移(offset)属性</span>
<span class=cm> CSize sz = rcWindow.Size();</span>
<span class=cm> CPoint ptOffset;</span>
<span class=cm> ptOffset.x = (LONG)(sz.cx * fOffsetX);</span>
<span class=cm> ptOffset.y = (LONG)(sz.cy * fOffsetY);</span>
<span class=cm> rcWindow.OffsetRect(ptOffset);</span>
<span class=cm> }</span>
<span class=cm> return nRet;</span>
<span class=cm> }</span>
</code></pre></div> <p>SwndLayout::CalcPosition 是 SOUI 用来通过 pos 及 offset 属性计算窗口坐标的关键函 数，为了突出重点，具体的坐标计算省略了，只列出平移处理部分的代码。 可以看出，在平移处理前，首先获得窗口的 Size,再将 Size 分别乘以 fOffsetX,fOffsetY 这 两个平移系数获得在 x,y 两个方向上的平移量。 最后才是将矩形做平移处理。 下面我们再来看看 pos2type 属性： pos2type 可以定义 9 个参考点：center, lefttop, leftmid, leftbottom,midtop,midbottom,righttop,rightmid,rightbottom。 下表显示对应原 pos2type 属性的 offset 属性：</p> <table> <thead> <tr> <th>pos2type</th> <th>offset</th> </tr> </thead> <tbody> <tr> <td>center</td> <td>-0.5,-0.5</td> </tr> <tr> <td>lefttop</td> <td>0,0</td> </tr> <tr> <td>leftmid</td> <td>0,-0.5</td> </tr> <tr> <td>leftbottom</td> <td>0,-1</td> </tr> <tr> <td>midtop</td> <td>-0.5,0</td> </tr> <tr> <td>midbottom</td> <td>-0.5,-1</td> </tr> <tr> <td>righttop</td> <td>-1,0</td> </tr> <tr> <td>rightmid</td> <td>-1,-0.5</td> </tr> <tr> <td>rightbottom</td> <td>-1,-1</td> </tr> </tbody> </table> <p>从上表可以看出，原来的 pos2type 属性只能是 0.5 的倍数，新的 offset 属性没有该限 制。 使用 pos2type 可能更为直观，但是 offset 属性则更灵活。如果两个属性同时使用，只有 最后一个属性有效。 注意：offset 属性是 2014.11.20 才新增加的属性，pos2type 属性的命名是为了兼容 2014.11.20 前的版本。 SOUI 布局之相对于特定兄弟窗口 SOUI 中通过 pos 的标志如：[, {, }, ]，这 4 个标志可以相对于前一个及后一个兄弟窗口， 但是有时候希望相对于不是前后窗口的兄弟窗口，比如一个通过一个中心窗口同时定义它 的上下左右 4 个窗口，这个时候应该如何处理？ 其实 SOUI 是支持相对于任意一个兄弟窗口的，但是定义方法有点复杂，所以在之前的博 客文章中都没有介绍。 定义的方法是这样的：</p> <p>首先被参考窗口（假定为窗口 A）必须要指定窗口的 ID 属性，有了 ID（假定 id=100)， 其它窗口才能引用它（这里指定 name 属性是不行的，系统只会通过 ID 去查询这个兄弟 窗口）。 然后一个窗口（假定为窗口 B）要相对于窗口 A 布局，只需要在 pos 中指定为如： pos="sib.left@100:-20,sib.bottom@100:30,@100,@100"，坐标定义中的 sib.left,sib.bottom 用来指定这两个坐标是相对于被引用窗口的 left,bottom 的值，坐标 中的 100:20,100:30 刚代表相对于 ID 为 100 的兄弟窗口的 left 向左偏移 20 像素及 bottom 向下偏移 30 像素。这里的负数是代表偏移方向，和没有 sib.xxx 时的负值意义不 同。 下面看下 demo 中的示例 XML(demo/uires/xml/page_layout.xml)：</p> <p><code>xml &lt;window skin="skin_page_icons" pos="[5,150,-10,-10" id="1236"&gt; &lt;text pos="|0,|0" offset="-0.5,-0.5" font="adding:20" colorText="#ff000066"&gt;alpha test&lt;/text&gt; &lt;text pos="5,5" id="100" visible="0"&gt;ref text&lt;/text&gt; &lt;button pos="sib.left@100:10,sib.bottom@100:10,@100,@25" name="btn_hidetst" tip="click me to hide me and see how the next image will move"&gt;ref id:100&lt;/button&gt; &lt;/window&gt;</code></p> <p>PS：这个定义方法有点山寨，将就着用吧，关键是能解决问题 :) 4.1.4 在 SOUI 中使用线性布局 SOUI 2.5.1.1 开始支持线性布局(LinearLayout). 要在 SOUI 布局中使用线性布局, 需要在布局容器窗口里指定布局类型为 vbox | hbox, (vbox 为垂直线性布局, hbox 为水平线性布局). 在指定布局类型后还可以为容器窗口指定 gravity 属性, 用来指定子窗口的默认排列模式. vbox 的 gravity 有:left(默认), center, right, hbox 有: top(默认), center, bottom. 在线性布局中的子窗口 pos 属性没有意义, 一般直接指定 size="width,height", width/height 值: -1 代表 wrap_content, -2 代表 match_parent 可以使用 layout_gravity 可以更改当前窗口的排列模式. 使用 extend="left,top,right,bottom", extend_left, extend_top, extend_right, extend_bottom 来指定间距. (相当于 android 的 margin) 子窗口支持使用 weight 属性. 看下面 demo 中的例子:</p> <p>```xml <page title="linear layout"> <!--这里演示在 SOUI 中使用线性布局,在 window 中指定
layout="vbox,hbox,linearLayout"时窗口的子窗口布局变成自动布局模式--></p> <p><window layout=vbox size=-1,-1 colorbkgnd=#cccccc gravity=center> <!--线性布局的自适应子窗口大小--></p> <p><text>vbox + gravity + wrapContent</text> <window size=100,30 colorbkgnd=#ff0000 /> <window size=200,30 extend=10,5,10,5 colorbkgnd=#ff0000 /> <window size=120,30 layout_gravity=right colorbkgnd=#ff0000 /> </window> <window pos=0,[5,@-1,@200 layout=vbox colorbkgnd=#cccccc> <!--线性布局的 weight 属性--></p> <p><text extend_bottom=10>vbox + gravity + weight</text> <window size=100,30 colorbkgnd=#ff0000 /> <window size=200,30 extend=10,5,10,5 colorbkgnd=#ff0000 weight=1 /> <window size=120,30 layout_gravity=right colorbkgnd=#ff0000 weight=1 /> <button size=100,30 extend_top=10>button test</button> </window> <window pos=0,[5 layout=vbox colorbkgnd=#cccccc id=10000> <text extend_bottom=10 layout_gravity=center>hbox demo</text> <window size=-1,-1 layout=hbox colorbkgnd=#888888> <!--线性布局之 hbox--></p> <p><button size=100,30>button1</button> <button size=100,30 extend_left=10>button2</button> <button size=100,30 extend_left=10>button3</button> <button size=100,30 extend_left=10>button4</button> </window> </window> </page> ```</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../0/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 4、SOUI 开发说明" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> 4、SOUI 开发说明 </div> </div> </a> <a href=../2/ class="md-footer__link md-footer__link--next" aria-label="下一页: 4.2 系统资源管理" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> 4.2 系统资源管理 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2010 - 2021 SoUI Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script> <script src=../../assets/javascripts/bundle.e1a181d9.min.js></script> <script src=https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js></script> <script src=../../static/js/extra.js></script> <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>