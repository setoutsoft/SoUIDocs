<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="C++ 快速设计界面库"><meta name=author content="SoUI Team"><link href=https://X.org/Ask/1/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.3"><title>6.1 模块 utilities 为什么要用 DLL 编译？ - SoUI3官方文档</title><link rel=stylesheet href=../../assets/stylesheets/main.edf004c2.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#ffffff><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../../static/css/extra.css><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=white data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#61-utilities-dll class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=SoUI3官方文档 class="md-header__button md-logo" aria-label=SoUI3官方文档 data-md-component=logo> <img src=../../static/img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SoUI3官方文档 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 6.1 模块 utilities 为什么要用 DLL 编译？ </span> </div> </div> </div> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label=选择当前语言> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=/ hreflang class=md-select__link> 中文 </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/2926295173/SoUIDocs/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> 2926295173/SoUIDocs </div> </a> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Start </a> </li> <li class=md-tabs__item> <a href=../../Overview/10/ class=md-tabs__link> 概述 </a> </li> <li class=md-tabs__item> <a href=../../BuildSoUI/build/ class=md-tabs__link> 编译 </a> </li> <li class=md-tabs__item> <a href=../../Create/31/ class=md-tabs__link> 创建 </a> </li> <li class=md-tabs__item> <a href=../../Development/0/ class=md-tabs__link> 开发 </a> </li> <li class=md-tabs__item> <a href=../../Control/Summary/ class=md-tabs__link> 控件 </a> </li> <li class=md-tabs__item> <a href=../Summary/ class="md-tabs__link md-tabs__link--active"> 提问 </a> </li> <li class=md-tabs__item> <a href=../../Others/1/ class=md-tabs__link> 其他 </a> </li> <li class=md-tabs__item> <a href=../../updatelog/ class=md-tabs__link> 更新 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SoUI3官方文档 class="md-nav__button md-logo" aria-label=SoUI3官方文档 data-md-component=logo> <img src=../../static/img/logo.png alt=logo> </a> SoUI3官方文档 </label> <div class=md-nav__source> <a href=https://github.com/2926295173/SoUIDocs/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> 2926295173/SoUIDocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Start <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Start data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Start </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> 引言 </a> </li> <li class=md-nav__item> <a href=../../discussion/ class=md-nav__link> 讨论交流与问题反馈 </a> </li> <li class=md-nav__item> <a href=../../theme/ class=md-nav__link> 网站主题配色 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> 概述 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=概述 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 概述 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Overview/10/ class=md-nav__link> 1、概述 </a> </li> <li class=md-nav__item> <a href=../../Overview/11/ class=md-nav__link> 1.1 SOUI 是什么？ </a> </li> <li class=md-nav__item> <a href=../../Overview/12/ class=md-nav__link> 1.2 SOUI 相对于 DuiEngine 的改进 </a> </li> <li class=md-nav__item> <a href=../../Overview/13/ class=md-nav__link> 1.3 SOUI 模块结构 </a> </li> <li class=md-nav__item> <a href=../../Overview/14/ class=md-nav__link> 1.4 模块结构图及框架图 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 编译 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=编译 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 编译 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../BuildSoUI/build/ class=md-nav__link> 2、SOUI 的编译 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> 创建 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=创建 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 创建 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Create/31/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/32/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/33/ class=md-nav__link> 3、开始使用 SOUI </a> </li> <li class=md-nav__item> <a href=../../Create/34/ class=md-nav__link> 3、开始使用 SOUI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> 开发 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=开发 data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Development/0/ class=md-nav__link> 4、SOUI 开发说明 </a> </li> <li class=md-nav__item> <a href=../../Development/1/ class=md-nav__link> 4.1 xml 资源文件定义 </a> </li> <li class=md-nav__item> <a href=../../Development/2/ class=md-nav__link> 4.2 系统资源管理 </a> </li> <li class=md-nav__item> <a href=../../Development/3/ class=md-nav__link> 4.3 应用程序中资源的组织 </a> </li> <li class=md-nav__item> <a href=../../Development/4/ class=md-nav__link> 4.4 在 SOUI 中用九宫格拉伸方式显示一个图片资源 </a> </li> <li class=md-nav__item> <a href=../../Development/7/ class=md-nav__link> 4.7 在 SOUI 中使用有窗口句柄的子窗口 </a> </li> <li class=md-nav__item> <a href=../../Development/8/ class=md-nav__link> 4.8 SOUI 中控件事件的响应 </a> </li> <li class=md-nav__item> <a href=../../Development/9/ class=md-nav__link> 4.9 SOUI 多语言翻译机制 </a> </li> <li class=md-nav__item> <a href=../../Development/10/ class=md-nav__link> 4.10 自定义控件 </a> </li> <li class=md-nav__item> <a href=../../Development/11/ class=md-nav__link> 4.11 在 SOUI 中使用定时器 </a> </li> <li class=md-nav__item> <a href=../../Development/12/ class=md-nav__link> 4.12 在 SOUI 中消息通讯 </a> </li> <li class=md-nav__item> <a href=../../Development/13/ class=md-nav__link> 4.13 使用窗口的 cache 属性加速 SOUI 的渲染 </a> </li> <li class=md-nav__item> <a href=../../Development/14/ class=md-nav__link> 4.14 在 SOUI 中实现 PreTranslateMessage </a> </li> <li class=md-nav__item> <a href=../../Development/15/ class=md-nav__link> 4.15 提高 SOUI 应用程序渲染性能的三种武器 </a> </li> <li class=md-nav__item> <a href=../../Development/16/ class=md-nav__link> 4.16 在 SOUI 中使用分层窗口 </a> </li> <li class=md-nav__item> <a href=../../Development/17/ class=md-nav__link> 4.17 在 SOUI 中的控件注册机制 </a> </li> <li class=md-nav__item> <a href=../../Development/18/ class=md-nav__link> 4.18 在 SOUI 中使用代码向窗口中插入子窗口 </a> </li> <li class=md-nav__item> <a href=../../Development/19/ class=md-nav__link> 4.19 在 SOUI 中使用 LUA 脚本开发界面 </a> </li> <li class=md-nav__item> <a href=../../Development/20/ class=md-nav__link> 4.20 导出 SOUI 对象到 LUA 脚本 </a> </li> <li class=md-nav__item> <a href=../../Development/21/ class=md-nav__link> 4.21 在 SOUI 中做事件分发处理 </a> </li> <li class=md-nav__item> <a href=../../Development/22/ class=md-nav__link> 4.22 在 SOUI 中使用异步通知 </a> </li> <li class=md-nav__item> <a href=../../Development/23/ class=md-nav__link> 4.23 在 SOUI2.0 中像 android 一样使用资源 </a> </li> <li class=md-nav__item> <a href=../../Development/24/ class=md-nav__link> 4.24 两个 SOUI 新控件 ---- SListView 和 SComboView（借用 Andorid 的设计） </a> </li> <li class=md-nav__item> <a href=../../Development/25/ class=md-nav__link> 4.25 在 SOUI 中控件属性查询方法 </a> </li> <li class=md-nav__item> <a href=../../Development/26/ class=md-nav__link> 4.26 使用 SOUI 的 SMCListView 控件 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> 控件 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=控件 data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 控件 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Control/Summary/ class=md-nav__link> 5、控件说明（SOUI） </a> </li> <li class=md-nav__item> <a href=../../Control/51/ class=md-nav__link> 5.1 SWindow 类 </a> </li> <li class=md-nav__item> <a href=../../Control/52/ class=md-nav__link> 5.2 SwndStyle 类 </a> </li> <li class=md-nav__item> <a href=../../Control/53/ class=md-nav__link> 5.3 SHostWndAttr 类 </a> </li> <li class=md-nav__item> <a href=../../Control/54/ class=md-nav__link> 5.4 静态文本控件 </a> </li> <li class=md-nav__item> <a href=../../Control/55/ class=md-nav__link> 5.5 超链接控件 </a> </li> <li class=md-nav__item> <a href=../../Control/56/ class=md-nav__link> 5.6 按钮/图片按钮控件 </a> </li> <li class=md-nav__item> <a href=../../Control/57/ class=md-nav__link> 5.7 图片控件 </a> </li> <li class=md-nav__item> <a href=../../Control/58/ class=md-nav__link> 5.8 动画图片窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/59/ class=md-nav__link> 5.9 线条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/510/ class=md-nav__link> 5.10 复选框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/511/ class=md-nav__link> 5.11 图标控件 </a> </li> <li class=md-nav__item> <a href=../../Control/512/ class=md-nav__link> 5.12 单选框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/513/ class=md-nav__link> 5.13 Toggle 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/514/ class=md-nav__link> 5.14 组控件 </a> </li> <li class=md-nav__item> <a href=../../Control/515/ class=md-nav__link> 5.15 可输入 CommboBox 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/516/ class=md-nav__link> 5.16 日历控件 </a> </li> <li class=md-nav__item> <a href=../../Control/517/ class=md-nav__link> 5.17 标签控件 </a> </li> <li class=md-nav__item> <a href=../../Control/518/ class=md-nav__link> 5.18 富文本编辑框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/519/ class=md-nav__link> 5.19 简单 edit 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/520/ class=md-nav__link> 5.20 表头控件 </a> </li> <li class=md-nav__item> <a href=../../Control/521/ class=md-nav__link> 5.21 热键控件 </a> </li> <li class=md-nav__item> <a href=../../Control/522/ class=md-nav__link> 5.22 列表框控件 </a> </li> <li class=md-nav__item> <a href=../../Control/523/ class=md-nav__link> 5.23 列表控件 </a> </li> <li class=md-nav__item> <a href=../../Control/524/ class=md-nav__link> 5.24 滚动条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/525/ class=md-nav__link> 5.25 滑块工具条控件 </a> </li> <li class=md-nav__item> <a href=../../Control/526/ class=md-nav__link> 5.26 分割窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/527/ class=md-nav__link> 5.27 分割窗口控件 </a> </li> <li class=md-nav__item> <a href=../../Control/528/ class=md-nav__link> 5.28 Tab 标签页面控件 </a> </li> <li class=md-nav__item> <a href=../../Control/529/ class=md-nav__link> 5.29 Tab 控件 </a> </li> <li class=md-nav__item> <a href=../../Control/530/ class=md-nav__link> 5.30 树控件 </a> </li> <li class=md-nav__item> <a href=../../Control/531/ class=md-nav__link> 5.31 按钮控件 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7> 提问 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=提问 data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 提问 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Summary/ class=md-nav__link> 6、常见问题 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> 6.1 模块 utilities 为什么要用 DLL 编译？ </a> </li> <li class=md-nav__item> <a href=../2/ class=md-nav__link> 6.2 为什么在 soui 中加载 JPG 文件失败？ </a> </li> <li class=md-nav__item> <a href=../3/ class=md-nav__link> 6.3 不注册 COM 在 Richedit 中使 OLE 支持复制粘贴 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> 其他 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=其他 data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Others/1/ class=md-nav__link> 7.1 谈谈 SOUI 与 WTL </a> </li> <li class=md-nav__item> <a href=../../Others/2/ class=md-nav__link> 7.2 在 SOUI 中非半透明窗口如何实现圆角窗口？ </a> </li> <li class=md-nav__item> <a href=../../Others/3/ class=md-nav__link> 7.4 一种高效的可变行高列表行定位算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> 更新 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=更新 data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 更新 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../updatelog/ class=md-nav__link> SoUI 版本更新日志 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/2926295173/SoUIDocs/blob/main/docs/zh/docs/Ask/1.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=61-utilities-dll>6.1 模块 utilities 为什么要用 DLL 编译？<a class=headerlink href=#61-utilities-dll title="Permanent link">&para;</a></h1> <p>SOUI 相对于 DuiEngine 一个重要的变化就是很多模块变成了一个单独的 DLL。 然后很多情况下用户可能希望整个产品就是一个 EXE，原来 DuiEngine 提供了 LIB 编译模 式，此时链接 LIB 模式的 DuiEngine 就行了。 但是 SOUI 默认至少 Utilities 那个模块是不提供 LIB 编译模式的。 utilities 之所以默认只提供 DLL 编译是因为 SString 类是由 utilities 实现的。 字符串是编译中碰到的最最见的基本对象之一。在运行库（CRT）动态编译（MD， MDd）时这不是问题，因为所有模块的内存分配都是在一个相同的运行库（CRT）上，这 时在不同模块之间传递对象相对简单。如果项目采用运行库静态编译（MT or MTd)，在 不同模块之间传递字符串对象是非常困难的，因为一不小心就会发生在 A 模块中分配的字 符串对象被 B 模块释放。 utilities 采用 DLL 编译就是为了解决这个字符串对象的跨模块传递。 采用运行库动态编译的情况就不说了，这里主要介绍采用静态库编译的 CRT 的情况。 SOUI 中使用的字符串对象采用了一点技巧：每一个 String 对象中只有一个指针成员变 量：</p> <div class=highlight><pre><span></span><code><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span> <span class=nc>tchar</span><span class=p>,</span><span class=w> </span><span class=k>class</span> <span class=nc>tchar_traits</span><span class=o>&gt;</span><span class=w></span>
<span class=w> </span><span class=k>class</span> <span class=nc>TStringT</span><span class=w></span>
<span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w> </span><span class=k>public</span><span class=o>:</span><span class=w></span>
<span class=w> </span><span class=k>typedef</span><span class=w> </span><span class=n>tchar</span><span class=w> </span><span class=n>_tchar</span><span class=p>;</span><span class=w></span>
<span class=w> </span><span class=k>typedef</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>_tchar</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pctstr</span><span class=p>;</span><span class=w></span>
<span class=w> </span><span class=k>protected</span><span class=o>:</span><span class=w></span>
<span class=w> </span><span class=n>tchar</span><span class=o>*</span><span class=w> </span><span class=n>m_pszData</span><span class=p>;</span><span class=w> </span><span class=c1>// pointer to ref counted string </span>
<span class=n>data</span><span class=w></span>
<span class=w> </span><span class=p>};</span><span class=w></span>
</code></pre></div> <p>虽然 TStringT 是一个模板类，在 SOUI 中采用类导出的方式将该模板的两个特化类导出：</p> <div class=highlight><pre><span></span><code><span class=cp>#ifdef UTILITIES_EXPORTS</span>
<span class=cp># define EXPIMP_TEMPLATE</span>
<span class=cp>#else</span>
<span class=cp># define EXPIMP_TEMPLATE extern</span>
<span class=cp>#endif</span>
<span class=w> </span><span class=cp>#pragma warning (disable : 4231)</span>
<span class=w> </span><span class=n>EXPIMP_TEMPLATE</span><span class=w> </span><span class=k>template</span><span class=w> </span><span class=k>class</span> <span class=nc>UTILITIES_API</span><span class=w> </span>
<span class=n>TStringT</span><span class=o>&lt;</span><span class=kt>char</span><span class=p>,</span><span class=w> </span><span class=n>char_traits</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
<span class=w> </span><span class=n>EXPIMP_TEMPLATE</span><span class=w> </span><span class=k>template</span><span class=w> </span><span class=k>class</span> <span class=nc>UTILITIES_API</span><span class=w> </span>
<span class=n>TStringT</span><span class=o>&lt;</span><span class=kt>wchar_t</span><span class=p>,</span><span class=w> </span><span class=n>wchar_traits</span><span class=o>&gt;</span><span class=p>;</span><span class=w></span>
</code></pre></div> <p>通过将 string 类导出，保证 string 的所有运行代码都是在 utilities 这个模块内部，这也就 保证了 string 对象的唯一成员变量： tchar* m_pszData； 的内存分配及释放固定在 utilities 这个模块里。 通过这样处理，无论用户定义 string 是在哪一个模块，真正的内存管理还是在 utilities 里，从而使得 string 对象可以方便的在不同模块之间传递。 比较一下 std::string 就可以发现，如果使用 std::string 在不同模块之间传递对象将是非常 危险的，因为 std::string 是模板类，它的代码将会被编译到不同的模块中，也就是说在不 同的模块中调用 std::string 的成员函数执行的代码是不一样的，这样在 A 模块中声明的 string 传递到 B 模块再被 B 模块释放程序就崩溃了。 这就是为什么 utilities 模块默认只提供 DLL 编译的原因。 知道了原因就好办了。 对于那些希望整个项目就是一个 EXE 的情况，直接修改 utilities 模块的编译类型为 LIB 就 行了，因为这种情况下根本不存在跨模块对象传递的问题。</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../Summary/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 6、常见问题" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> 6、常见问题 </div> </div> </a> <a href=../2/ class="md-footer__link md-footer__link--next" aria-label="下一页: 6.2 为什么在 soui 中加载 JPG 文件失败？" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> 6.2 为什么在 soui 中加载 JPG 文件失败？ </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2010 - 2021 SoUI Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script> <script src=../../assets/javascripts/bundle.e1a181d9.min.js></script> <script src=https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js></script> <script src=../../static/js/extra.js></script> <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>